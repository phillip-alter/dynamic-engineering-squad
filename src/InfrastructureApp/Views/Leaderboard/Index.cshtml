@model InfrastructureApp.ViewModels.LeaderboardIndexViewModel

<!--
    This view is strongly typed to LeaderboardIndexViewModel.
    The controller is responsible for populating this model before passing it to the view.-->


<h1>Leaderboard</h1>

<!--displays contextual info about how many entries  are currently being shown-->
<p>Top @Model.TopN</p>

@if (Model.Entries.Count == 0)
{
    <p><em>No contributions yet.</em></p>
}
else
{
       <!--
        Bootstrap-styled table used for consistent layout and readability.
        table-striped improves row distinction for scanning rankings.
    -->

    <table class="table table-striped">
        <thead>
            <tr>
                  <!--
                    Column headers define the leaderboard schema:
                    Rank → position in the sorted list
                    User → display identifier
                    Points → score used for ranking
                    Updated → last time the score changed
                -->
                <th>Rank</th>
                <th>User</th>
                <th>Points</th>
                <th>Updated</th>
            </tr>
        </thead>
        <tbody>
              @*
                Use a for-loop instead of foreach so we can:
                - Easily calculate rank (index + 1)
                - Guarantee stable ordering matching the service output
            *@
@{
    int rank = 1;   // human-friendly ranking counter
}

@foreach (var entry in Model.Entries)
{
    <tr>
        <!--
            Rank is manually incremented because foreach
            does not provide an index like a for loop.
        -->
        <td>@rank</td>

        <!--
            Display name or identifier for the user.
            This value is already sanitized and validated
            by the service layer.
        -->
        <td>@entry.UserId</td>

        <!--
            UserPoints represents the score used to order
            the leaderboard.
        -->
        <td>@entry.UserPoints</td>

        <!--
            Convert UTC time stored in the database to the
            user's local time for readability.
        -->
        <td>@entry.UpdatedAtUtc.ToLocalTime().ToString("g")</td>
    </tr>

    rank++;   // move to next leaderboard position
}

        </tbody>
    </table>
}
